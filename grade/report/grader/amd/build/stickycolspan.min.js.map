{"version":3,"file":"stickycolspan.min.js","sources":["../src/stickycolspan.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Javascript module for fixing the position of sticky headers with multiple colspans\r\n *\r\n * @module      gradereport_grader/stickycolspan\r\n * @copyright   2022 Bas Brands <bas@moodle.com>\r\n * @license     http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\r\n */\r\n\r\nconst SELECTORS = {\r\n    GRADEPARENT: '.gradeparent',\r\n    STUDENTHEADER: '#studentheader',\r\n    TABLEHEADER: 'th.header',\r\n    BEHAT: 'body.behat-site'\r\n};\r\n\r\n/**\r\n * Initialize module\r\n */\r\nexport const init = () => {\r\n    if (document.querySelector(SELECTORS.BEHAT)) {\r\n        return;\r\n    }\r\n    const grader = document.querySelector(SELECTORS.GRADEPARENT);\r\n    const studentHeader = grader.querySelector(SELECTORS.STUDENTHEADER);\r\n    const leftOffset = getComputedStyle(studentHeader).getPropertyValue('left');\r\n    const rightOffset = getComputedStyle(studentHeader).getPropertyValue('right');\r\n\r\n    grader.querySelectorAll(SELECTORS.TABLEHEADER).forEach((tableHeader) => {\r\n        if (tableHeader.colSpan > 1) {\r\n            const addOffset = (tableHeader.offsetWidth - studentHeader.offsetWidth);\r\n            if (window.right_to_left()) {\r\n                tableHeader.style.right = 'calc(' + rightOffset + ' - ' + addOffset + 'px )';\r\n            } else {\r\n                tableHeader.style.left = 'calc(' + leftOffset + ' - ' + addOffset + 'px )';\r\n            }\r\n        }\r\n    });\r\n};\r\n"],"names":["SELECTORS","document","querySelector","grader","studentHeader","leftOffset","getComputedStyle","getPropertyValue","rightOffset","querySelectorAll","forEach","tableHeader","colSpan","addOffset","offsetWidth","window","right_to_left","style","right","left"],"mappings":";;;;;;;;MAuBMA,sBACW,eADXA,wBAEa,iBAFbA,sBAGW,YAHXA,gBAIK,gCAMS,QACZC,SAASC,cAAcF,8BAGrBG,OAASF,SAASC,cAAcF,uBAChCI,cAAgBD,OAAOD,cAAcF,yBACrCK,WAAaC,iBAAiBF,eAAeG,iBAAiB,QAC9DC,YAAcF,iBAAiBF,eAAeG,iBAAiB,SAErEJ,OAAOM,iBAAiBT,uBAAuBU,SAASC,iBAChDA,YAAYC,QAAU,EAAG,OACnBC,UAAaF,YAAYG,YAAcV,cAAcU,YACvDC,OAAOC,gBACPL,YAAYM,MAAMC,MAAQ,QAAUV,YAAc,MAAQK,UAAY,OAEtEF,YAAYM,MAAME,KAAO,QAAUd,WAAa,MAAQQ,UAAY"}